name: 'Test'
description: 'Test using devcontainer'
runs:
  using: "composite"
  steps:
    - name: Print working directory
      shell: bash
      run: pwd

    - name: Build
      shell: bash
      run: docker-compose -f ../docker-compose.ci.yml build

    - name: Run
      shell: bash
      run: docker-compose -f ../docker-compose.ci.yml up -d

    - name: Test
      shell: bash
      run: |
        docker-compose -f ../docker-compose.ci.yml exec -u ros sailbot-workspace /bin/bash
        cd /workspaces/sailbot_workspace
        .github/actions/test/run.sh
